
<div class="flex flex-col items-center justify-center p-6 w-full max-w-2xl min-h-screen">
  
  <!-- Header / Nav -->
  <header class="w-full flex justify-between items-center mb-12">
    <div class="flex items-center gap-2">
      <div class="w-8 h-8 bg-rose-500 rounded-lg flex items-center justify-center">
        <i class="fa-solid fa-clock text-white text-sm"></i>
      </div>
      <h1 class="text-xl font-bold tracking-tight">FocusFlow</h1>
    </div>
    <button (click)="isSettingsOpen.set(true)" 
            class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-900 border border-slate-800 hover:border-slate-700 transition-all">
      <i class="fa-solid fa-gear text-slate-400"></i>
    </button>
  </header>

  <!-- Timer Card -->
  <main class="w-full bg-slate-900/40 backdrop-blur-md border border-slate-800/50 rounded-[2.5rem] p-12 relative overflow-hidden flex flex-col items-center transition-colors duration-500"
        [class]="getModeBgClass()">
    
    <!-- Mode Switcher -->
    <nav class="flex p-1 bg-slate-950/50 rounded-2xl mb-12 border border-slate-800">
      <button (click)="setMode('work')"
              [class]="timer.mode() === 'work' ? 'bg-slate-800 text-rose-400 shadow-sm' : 'text-slate-400 hover:text-slate-200'"
              class="px-5 py-2.5 rounded-xl text-xs font-bold uppercase tracking-wider transition-all">
        Focus
      </button>
      <button (click)="setMode('shortBreak')"
              [class]="timer.mode() === 'shortBreak' ? 'bg-slate-800 text-emerald-400 shadow-sm' : 'text-slate-400 hover:text-slate-200'"
              class="px-5 py-2.5 rounded-xl text-xs font-bold uppercase tracking-wider transition-all">
        Short
      </button>
      <button (click)="setMode('longBreak')"
              [class]="timer.mode() === 'longBreak' ? 'bg-slate-800 text-blue-400 shadow-sm' : 'text-slate-400 hover:text-slate-200'"
              class="px-5 py-2.5 rounded-xl text-xs font-bold uppercase tracking-wider transition-all">
        Long
      </button>
    </nav>

    <!-- Timer Visual -->
    <app-timer-display class="mb-12" />

    <!-- Main Controls -->
    <div class="flex items-center gap-6">
      <button (click)="timer.reset()" 
              class="w-14 h-14 flex items-center justify-center rounded-2xl bg-slate-950 border border-slate-800 text-slate-400 hover:text-white hover:border-slate-700 transition-all">
        <i class="fa-solid fa-rotate-right text-lg"></i>
      </button>

      <button (click)="timer.toggle()" 
              [class]="timer.isRunning() ? 'bg-slate-200 text-slate-950' : 'bg-rose-500 text-white'"
              class="px-10 h-16 rounded-2xl font-bold text-lg uppercase tracking-widest shadow-2xl transition-all active:scale-95 group">
        @if (timer.isRunning()) {
          <span class="flex items-center gap-3">
            <i class="fa-solid fa-pause"></i> Pause
          </span>
        } @else {
          <span class="flex items-center gap-3">
            <i class="fa-solid fa-play"></i> Focus
          </span>
        }
      </button>

      <button (click)="timer.setMode(timer.mode())"
              class="w-14 h-14 flex items-center justify-center rounded-2xl bg-slate-950 border border-slate-800 text-slate-400 hover:text-white hover:border-slate-700 transition-all">
        <i class="fa-solid fa-forward-step text-lg"></i>
      </button>
    </div>
  </main>

  <!-- Footer Stats -->
  <footer class="w-full mt-12 grid grid-cols-2 gap-6">
    <!-- Daily Progress -->
    <div class="bg-slate-900/50 rounded-3xl p-6 border border-slate-800">
      <div class="flex justify-between items-center mb-4">
        <span class="text-xs font-bold uppercase tracking-widest text-slate-500">Daily Goal</span>
        <span class="text-sm font-bold text-slate-200">{{ timer.sessionsCompletedToday() }} / {{ timer.settings().goal }}</span>
      </div>
      <div class="w-full h-2 bg-slate-800 rounded-full overflow-hidden">
        <div class="h-full bg-rose-500 transition-all duration-500" 
             [style.width.%]="(timer.sessionsCompletedToday() / timer.settings().goal) * 100"></div>
      </div>
    </div>

    <!-- History Peek -->
    <div class="bg-slate-900/50 rounded-3xl p-6 border border-slate-800 relative overflow-hidden">
      <div class="flex items-center justify-between mb-4">
        <span class="text-xs font-bold uppercase tracking-widest text-slate-500">Recent Sessions</span>
        <i class="fa-solid fa-history text-slate-600 text-xs"></i>
      </div>
      <div class="space-y-2">
        @for (session of timer.history().slice(0, 2); track session.id) {
          <div class="flex items-center justify-between text-xs text-slate-400">
            <span class="flex items-center gap-2">
              <span class="w-1.5 h-1.5 rounded-full bg-rose-500"></span>
              Focus ({{ session.durationMinutes }}m)
            </span>
            <span>{{ formatTime(session.timestamp) }}</span>
          </div>
        } @empty {
          <div class="text-[10px] text-slate-600 italic">No sessions yet today. Get started!</div>
        }
      </div>
    </div>
  </footer>

  <!-- Settings Modal -->
  @if (isSettingsOpen()) {
    <app-settings-modal (close)="isSettingsOpen.set(false)" />
  }

</div>
